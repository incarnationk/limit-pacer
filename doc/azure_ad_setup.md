# Azure AD アプリ登録手順 (App Registration Guide)

`limit-pacer` を Microsoft Entra ID (旧 Azure AD) で認証できるようにするための登録手順です。

## 1. アプリの登録
1. [Microsoft Azure Portal](https://portal.azure.com/) にアクセスし、ログインします。
2. 検索バーで **"Microsoft Entra ID"** を検索して選択します。
3. 左側のメニューから **「アプリの登録 (App registrations)」** をクリックします。
4. **「＋ 新規登録 (New registration)」** をクリックします。
5. 以下の通り入力します：
    - **名前**: `limit-pacer-dev` (任意ですが、開発用とわかる名前がおすすめ)
    - **サポートされているアカウントの種類**:
        - **"この組織のディレクトリ内のアカウントのみ (シングル テナント)"** を選択します（社内ツールの場合）。
    - **リダイレクト URI (オプション)**:
        - プラットフォーム: **「シングルページ アプリケーション (SPA)」** を選択
        - URL: `http://localhost:3000` (開発用)
6. **「登録 (Register)」** をクリックします。

## 2. 必要な情報の取得
登録完了後の「概要 (Overview)」ページで、以下の値をコピーして保存してください。

- **アプリケーション (クライアント) ID** (`Application (client) ID`)
- **ディレクトリ (テナント) ID** (`Directory (tenant) ID`)

## 3. 認証設定 (Authentication)
1. 左側のメニューから **「認証 (Authentication)」** をクリックします。
2. 「暗黙的な付与とハイブリッド フロー」セクションで、以下にチェックを入れます：
    - [x] **アクセストークン (暗黙的なフローに使用)**
    - [x] **ID トークン (暗黙的およびハイブリッド フローに使用)**
3. **「保存 (Save)」** をクリックします。

## 4. API のアクセス許可 (API Permissions)
1. 左側のメニューから **「API のアクセス許可 (API permissions)」** をクリックします。
2. デフォルトで `User.Read` (サインインとユーザープロファイルの読み取り) があるはずです。
3. **「＋ アクセス許可の追加 (Add a permission)」** をクリックします。
4. **"Microsoft Graph"** > **"委任されたアクセス許可 (Delegated permissions)"** を選択します。
5. 以下の権限を検索してチェックを入れます：
    - `Sites.Read.All` (SharePointリストの読み取り用)
    - `Sites.ReadWrite.All` (SharePointリストへの書き込み用)
6. **「アクセス許可の追加」** をクリックして確定します。
7. (重要) リスト一覧に戻ったら、**「{組織名} に管理者の同意を与えます (Grant admin consent for ... )」** ボタンが表示されている場合は、クリックして許可を与えてください。
   - ※これを行わないと、ユーザーがログインするたびに許可を求められるか、エラーになる場合があります。

---
**完了したら、取得した「クライアントID」と「テナントID」を教えてください。**
